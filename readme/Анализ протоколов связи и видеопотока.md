# Анализ протоколов связи и видеопотока

## MAVLink Протокол

### Основные характеристики:
- **Назначение**: Легковесный протокол для связи с дронами и между бортовыми компонентами
- **Архитектура**: Header-only message marshalling library
- **Версии**: MAVLink v1.0 и v2.0
- **Применение**: PX4, ArduPilot, QGroundControl, Mission Planner

### Требования к пропускной способности:
- **Стандартная телеметрия**: 30-50% от доступной пропускной способности
- **Высокоскоростная телеметрия**: 921600 бaud для потоковой передачи
- **Низкая задержка**: Возможна конфигурация с MAX_WINDOW=33ms (вместо стандартных 131ms)
- **Частота обновления**: 50-100Hz для критических данных

### Задержки:
- **MQTT через MAVLink**: Средняя задержка 27.78ms (стандартное отклонение низкое)
- **Высокая задержка (спутниковые каналы)**: >1 секунда (например, Iridium)
- **Локальная сеть**: <50ms при правильной конфигурации

### Особенности для реального времени:
- Оптимизирован для ненадежных каналов с низкой пропускной способностью
- Поддержка мониторинга телеметрии и загрузки миссий в реальном времени
- Возможность настройки приоритетов сообщений

## H.264 Видеопротокол

### Преимущества для дронов:
- **Низкая задержка**: Возможность достижения <100ms при правильной настройке
- **Широкая совместимость**: Поддержка большинством устройств и платформ
- **Эффективное сжатие**: Оптимальное соотношение качество/размер файла
- **Аппаратное ускорение**: Поддержка NVENC/NVDEC на Jetson платформах

### Jetson Nano специфика:
- **Аппаратный кодировщик**: omxh264enc в GStreamer
- **Ограничения**: Jetson Orin Nano не имеет аппаратного кодировщика (только программный x264enc)
- **Производительность**: Реальное время при правильной конфигурации GStreamer pipeline

### Конфигурация для минимальной задержки:
```bash
# GStreamer pipeline для низкой задержки
gst-launch-1.0 v4l2src ! video/x-raw,width=1920,height=1080,framerate=30/1 ! \
omxh264enc bitrate=5000000 control-rate=2 ! \
h264parse ! rtph264pay ! udpsink host=192.168.1.100 port=5600
```

### Альтернативы H.264:
- **H.265**: Лучшее сжатие, но выше задержка и требования к вычислительным ресурсам
- **Аналоговая передача**: Ультранизкая задержка (<20ms), но ограниченное качество

## Требования к пропускной способности

### MAVLink телеметрия:
- **Минимум**: 9600 baud для базовой телеметрии
- **Рекомендуемо**: 57600-115200 baud для полной функциональности
- **Высокоскоростной режим**: 921600 baud для потоковых данных

### H.264 видео:
- **720p@30fps**: 2-5 Mbps
- **1080p@30fps**: 5-10 Mbps
- **4K@30fps**: 15-25 Mbps
- **Факторы влияния**: Сложность сцены, движение, качество

### Общие требования системы:
- **Uplink (управление)**: 100-500 kbps
- **Downlink (телеметрия + видео)**: 5-25 Mbps
- **Задержка критична**: <200ms для управления, <100ms желательно для видео

